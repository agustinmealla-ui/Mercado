# üìä MERCADO - Sistema de An√°lisis de Opciones Financieras

> Sistema completo de an√°lisis cuantitativo de opciones financieras con c√°lculo en tiempo real usando el modelo Black-Scholes

---

## üìã Tabla de Contenidos

- [Requisitos Previos](#-requisitos-previos)
- [Instalaci√≥n](#-instalaci√≥n)
- [Configuraci√≥n](#-configuraci√≥n)
- [Integraci√≥n con Claude Desktop](#-integraci√≥n-con-claude-desktop)
- [Ejecuci√≥n](#-ejecuci√≥n)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [Caracter√≠sticas](#-caracter√≠sticas)
- [API Endpoints](#-api-endpoints)
- [Soluci√≥n de Problemas](#-soluci√≥n-de-problemas)
- [Desarrollo](#-desarrollo)

---

## üîß Requisitos Previos

### Backend
- **Python** >= 3.10
- **pip** o **uv** (gestor de paquetes Python)

### Frontend
- **Node.js** >= 16
- **npm** o **yarn**

### API Keys
- **FRED API Key**: Requerida para obtener tasas libres de riesgo
  - üîó [Obtener API Key](https://fred.stlouisfed.org/docs/api/api_key.html)

---

## üì¶ Instalaci√≥n

### 1Ô∏è‚É£ Backend (Server)

```bash
# Navegar al directorio del servidor
cd Server

# Instalar con uv (recomendado)
uv pip install -e .

# O con pip
pip install -e .
```

### 2Ô∏è‚É£ Frontend (Opciones)

```bash
# Navegar al directorio del frontend
cd Opciones

# Instalar dependencias
npm install

```

---

## ‚öôÔ∏è Configuraci√≥n

### Backend - Variables de Entorno

1. Crear archivo `.env` en el directorio `Server`:

```bash
# Linux/Mac
cd Server
touch .env

# Windows
cd Server
type nul > .env
```

2. Agregar tu FRED API Key:

```env
FRED_API_KEY='tu-api-key-aqui'
```

### Frontend - Variables de Entorno (Opcional)

Crear archivo `.env` en el directorio `Opciones`:

```env
VITE_API_URL=http://localhost:8000
```

---

## ü§ñ Integraci√≥n con Claude Desktop

El servidor MCP (Model Context Protocol) permite integrar las herramientas de an√°lisis de opciones directamente en Claude Desktop.

### Configuraci√≥n del Servidor MCP

#### 1Ô∏è‚É£ Ubicaci√≥n del Archivo de Configuraci√≥n

El archivo de configuraci√≥n de Claude Desktop se encuentra en:

**Windows:**
```
%APPDATA%\Claude\claude_desktop_config.json
```
Ruta completa t√≠pica: `C:\Users\TuUsuario\AppData\Roaming\Claude\claude_desktop_config.json`

**macOS:**
```
~/Library/Application Support/Claude/claude_desktop_config.json
```

**Linux:**
```
~/.config/Claude/claude_desktop_config.json
```

#### 2Ô∏è‚É£ Configurar el Servidor

Editar el archivo `claude_desktop_config.json` y agregar la siguiente configuraci√≥n:

**Para Windows:**
```json
{
  "mcpServers": {
    "mcp-opciones-mercado": {
      "command": "uv",
      "args": [
        "--directory",
        "c:/MERCADO/MERCADO/Server",
        "run",
        "python",
        "main.py"
      ],
      "env": {
        "FRED_API_KEY": "tu-api-key-aqui"
      }
    }
  }
}
```

**Para macOS/Linux:**
```json
{
  "mcpServers": {
    "mcp-opciones-mercado": {
      "command": "uv",
      "args": [
        "--directory",
        "/ruta/completa/a/MERCADO/Server",
        "run",
        "python",
        "main.py"
      ],
      "env": {
        "FRED_API_KEY": "tu-api-key-aqui"
      }
    }
  }
}
```

> ‚ö†Ô∏è **Importante:** Reemplazar `tu-api-key-aqui` con tu FRED API Key real

#### 3Ô∏è‚É£ Ajustar la Ruta del Proyecto

Reemplazar la ruta del directorio seg√∫n tu instalaci√≥n:

```json
// Windows - Ejemplos:
"c:/MERCADO/MERCADO/Server"
"c:/Users/TuUsuario/Documents/MERCADO/Server"
"D:/Proyectos/MERCADO/Server"

// macOS/Linux - Ejemplos:
"/Users/tuusuario/MERCADO/Server"
"/home/tuusuario/proyectos/MERCADO/Server"
```

#### 4Ô∏è‚É£ Verificar la Instalaci√≥n de UV

Asegurarse de que `uv` est√© instalado y accesible desde la l√≠nea de comandos:

```bash
# Verificar instalaci√≥n
uv --version

# Si no est√° instalado, instalarlo con:
pip install uv
# O en macOS/Linux:
curl -LsSf https://astral.sh/uv/install.sh |
---

## üéØ Caracter√≠sticas

### Backend (Server)

#### üõ†Ô∏è Herramientas de An√°lisis

| Herramienta | Descripci√≥n |
|-------------|-------------|
| `get_expiration` | Obtener fechas de vencimiento disponibles |
| `get_option_chain` | Cadena completa de opciones (calls/puts) |
| `compute_greeks_chain` | Calcular griegas para toda la cadena |
| `get_implied_distribution` | Distribuci√≥n impl√≠cita de probabilidad |
| `compute_option_payoff` | Perfil de payoff de estrategias |
| `get_historical_prices` | Precios hist√≥ricos del subyacente |

####  Caracter√≠sticas T√©cnicas

- Modelo **Black-Scholes** para valoraci√≥n de opciones
-  Integraci√≥n con **Yahoo Finance** (yfinance)
-  Tasas libres de riesgo desde **FRED** (Federal Reserve)

### Frontend (Opciones)

#### üìë Pesta√±as Principales

1. **Option Chain** - Visualizaci√≥n completa de la cadena de opciones
2. **Distribution** - Distribuci√≥n de probabilidad impl√≠cita
3. **Payoff** - Constructor de estrategias y perfiles de payoff
4. **Builder** - Constructor de prompt

---

## üîå API Endpoints

### Backend API (Puerto 8000)

| M√©todo | Endpoint | Descripci√≥n |
|--------|----------|-------------|
| `POST` | `/api/mcp/call-tool` | Llamar cualquier herramienta de an√°lisis |
| `GET` | `/health` | Health check del servidor |
| `GET` | `/docs` | Documentaci√≥n Swagger interactiva |
| `GET` | `/redoc` | Documentaci√≥n ReDoc |

#### Ejemplo de Request

```bash
curl -X POST "http://localhost:8000/api/mcp/call-tool" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "get_option_chain",
    "arguments": {
      "ticker": "AAPL",
      "expiration": "2024-01-19"
    }
  }'
```

---

## üîç Soluci√≥n de Problemas

### Backend

#### ‚ùå Error: "FRED_API_KEY not found"

**Soluci√≥n:**
```bash
# Verificar que .env existe en Server/
cd Server
cat .env  # Linux/Mac
type .env # Windows

# Debe contener:
# FRED_API_KEY='tu-api-key-real'
```

#### ‚ùå Error: "Module not found"

**Soluci√≥n:**
```bash
cd Server
uv pip install -e .
# O reinstalar todas las dependencias
pip install --force-reinstall -e .
```

#### ‚ùå Puerto 8000 ocupado

**Soluci√≥n:**
```bash
# Cambiar puerto en api_server.py
uvicorn.run(app, host="0.0.0.0", port=8001)

# O liberar el puerto (Linux/Mac)
lsof -ti:8000 | xargs kill -9

# Windows
netstat -ano | findstr :8000
taskkill /PID <PID> /F
```

### Frontend

#### ‚ùå Error: "Failed to fetch"

**Soluci√≥n:**
1. Verificar que el backend est√© corriendo en `http://localhost:8000`
2. Revisar archivo `.env` si existe:
   ```env
   VITE_API_URL=http://localhost:8000
   ```
3. Verificar CORS en el backend

#### ‚ùå Puerto 5173 ocupado

**Soluci√≥n:**
```bash
# El puerto se asignar√° autom√°ticamente al siguiente disponible
npm run dev -- --port 5174
```

#### ‚ùå Dependencias desactualizadas

**Soluci√≥n:**
```bash
# Actualizar todas las dependencias
npm update

# O reinstalar
rm -rf node_modules package-lock.json
npm install
```

---




### Metodolog√≠a de Desarrollo

#### Backend
- **Todas las tools** desarrolladas manualmente por mi en `core/tools/`
- **Modelos** definidos en `model/` creados por mi.
- **Utilidades** en `utils/` creados por mi.
- ‚ö†Ô∏è **√önica tool generada por IA:** `get_historical_prices.py`

#### Frontend
- ü§ñ **Completamente generado por IA**
- üîó **Conecta con backend** a trav√©s de `api_server.py`
- üì° **Comunicaci√≥n REST API** v√≠a `/api/mcp/call-tool`

---

##  Notas Importantes

- Los datos de opciones tienen un delay de ~15 minutos (Yahoo Finance)
- Las tasas libres de riesgo se actualizan diariamente desde FRED
---

## ü§ù Contribuciones

Para contribuir al proyecto:

1. Fork el repositorio
2. Crear una rama feature (`git checkout -b feature/AmazingFeature`)
3. Commit los cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abrir un Pull Request

---

## üìß Soporte

Para reportar bugs o solicitar features, crear un issue en el repositorio.

---

<div align="center">

**Hecho con ‚ù§Ô∏è para an√°lisis cuantitativo de opciones**

[‚¨Ü Volver arriba](#-mercado---sistema-de-an√°lisis-de-opciones-financieras)

</div>